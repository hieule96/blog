{{ $css := resources.Get "css/heavenly.css" }}
{{ if $css }}
<link rel="stylesheet" href="{{ $css.RelPermalink }}">
{{ end }}

{{ $js := resources.Get "js/wave.js" }}
{{ if $js }}
<script src="{{ $js.RelPermalink }}" defer></script>
{{ end }}

<!-- Mermaid.js for diagram rendering -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialize mermaid
        mermaid.initialize({
            startOnLoad: false,
            theme: document.documentElement.classList.contains('dark') ? 'dark' : 'default',
            securityLevel: 'loose'
        });

        // Find all mermaid code blocks and render them
        document.querySelectorAll('pre code.language-mermaid').forEach(function (block) {
            const pre = block.parentElement;
            const code = block.textContent;

            // Create a container for the diagram
            const container = document.createElement('div');
            container.className = 'mermaid';
            container.textContent = code;

            // Replace the pre block with the mermaid container
            pre.parentNode.replaceChild(container, pre);
        });

        // Also handle already-wrapped mermaid divs
        mermaid.run();
    });
</script>

<style>
    /* Scrollbar hide utility */
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }

    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }

    /* Mermaid styling */
    .mermaid {
        text-align: center;
        margin: 1.5rem 0;
        background: #f8fafc;
        padding: 1rem;
        border-radius: 0.75rem;
    }

    .dark .mermaid {
        background: #1e293b;
    }

    /* Line clamp utilities */
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>